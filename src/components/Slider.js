import { Animated, FlatList, StyleSheet, Text, View } from 'react-native';
import React, { useRef, useState } from 'react';
import SlideItem from './SliderItem';
import Pagination from './Pagination';
import { Svg, Circle, Path } from 'react-native-svg'
const Slider = () => {
    const Slides = [
        {
            title: "Daily meditation",
            svg:
                <Svg width="270" height="270" viewBox="0 0 270 270" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <Path d="M0.671631 20.6716C0.671631 9.62594 9.62594 0.671631 20.6716 0.671631H249.328C260.374 0.671631 269.328 9.62594 269.328 20.6716V249.328C269.328 260.374 260.374 269.328 249.328 269.328H20.6716C9.62594 269.328 0.671631 260.374 0.671631 249.328V20.6716Z" fill="#EFEAD4" />
                    <Circle cx="206.642" cy="74.5522" r="40.2985" fill="#E99028" />
                    <Path d="M269.328 185.107C265.851 184.571 262.309 184.466 258.806 184.846C238.095 187.084 221.674 203.987 201.491 209.184C185.508 213.295 168.004 209.512 154.249 200.255C143.893 193.29 133.062 184.518 121.47 180.014C105.061 173.638 84.5955 184.688 69.8096 175.052C61.4894 169.632 57.8959 159.368 52.3062 151.08C43.2518 137.66 27.7575 128.967 11.761 128.312C7.49785 128.142 3.82715 128.731 0.671631 129.91V231.271H269.328V185.107Z" fill="#6BB1C8" />
                    <Path d="M269.328 200.006C265.648 199.434 261.899 199.322 258.192 199.727C236.273 202.112 218.894 220.116 197.534 225.652C180.618 230.031 162.094 226.001 147.536 216.141C136.576 208.722 125.113 199.378 112.845 194.581C95.479 187.789 73.8194 199.56 58.171 189.295C49.3654 183.522 45.5624 172.588 39.6465 163.76C30.064 149.466 13.6659 140.206 -3.26374 139.508C-7.77559 139.327 -11.6604 139.955 -15 141.21V249.179H269.328V200.006Z" fill="#7BDADE" />
                    <Path d="M269.328 215.137C265.242 214.507 261.081 214.384 256.964 214.83C232.629 217.458 213.334 237.299 189.62 243.401C170.839 248.227 150.272 243.785 134.11 232.919C121.942 224.743 109.215 214.446 95.5947 209.159C76.3145 201.674 52.2672 214.646 34.8939 203.334C25.1176 196.971 20.8953 184.922 14.3273 175.193C3.6884 159.44 -14.5173 149.235 -33.3132 148.467C-38.3225 148.267 -42.6355 148.959 -46.3433 150.342V269.328H269.328V215.137Z" fill="#BCF3FD" />
                </Svg>
        },
        {
            title: "Meditation",
            svg:
                <Svg width="185" height="270" viewBox="0 0 185 270" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <Path d="M-84.3284 20.6716C-84.3284 9.62594 -75.3741 0.671631 -64.3284 0.671631H164.328C175.374 0.671631 184.328 9.62594 184.328 20.6716V249.328C184.328 260.374 175.374 269.328 164.328 269.328H-64.3284C-75.3741 269.328 -84.3284 260.374 -84.3284 249.328V20.6716Z" fill="#EFEAD4" />
                    <Circle cx="121.642" cy="74.5522" r="40.2985" fill="#E99028" />
                    <Path d="M184.328 185.107C180.851 184.571 177.309 184.466 173.806 184.846C153.095 187.084 136.674 203.987 116.491 209.184C100.508 213.295 83.0041 209.512 69.2486 200.255C58.8934 193.29 48.0616 184.518 36.4699 180.014C20.0612 173.638 -0.404541 184.688 -15.1904 175.052C-23.5106 169.632 -27.1041 159.368 -32.6938 151.08C-41.7482 137.66 -57.2425 128.967 -73.239 128.312C-77.5022 128.142 -81.1729 128.731 -84.3284 129.91V231.271H184.328V185.107Z" fill="#6BB1C8" />
                    <Path d="M184.328 200.006C180.648 199.434 176.899 199.322 173.192 199.727C151.273 202.112 133.894 220.116 112.534 225.652C95.618 230.031 77.0935 226.001 62.5356 216.141C51.5764 208.722 40.1127 199.378 27.8448 194.581C10.479 187.789 -11.1806 199.56 -26.829 189.295C-35.6346 183.522 -39.4376 172.588 -45.3535 163.76C-54.936 149.466 -71.3341 140.206 -88.2637 139.508C-92.7756 139.327 -96.6604 139.955 -100 141.21V249.179H184.328V200.006Z" fill="#7BDADE" />
                    <Path d="M184.328 215.137C180.242 214.507 176.081 214.384 171.964 214.83C147.629 217.458 128.334 237.299 104.62 243.401C85.8389 248.227 65.2724 243.785 49.1097 232.919C36.9423 224.743 24.215 214.446 10.5947 209.159C-8.68547 201.674 -32.7328 214.646 -50.1061 203.334C-59.8824 196.971 -64.1047 184.922 -70.6727 175.193C-81.3116 159.44 -99.5173 149.235 -118.313 148.467C-123.322 148.267 -127.636 148.959 -131.343 150.342V269.328H184.328V215.137Z" fill="#BCF3FD" />
                </Svg>
        },
        {
            title: "Affirmation",
            svg:
                <Svg width="184" height="270" viewBox="0 0 184 270" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <Path d="M0.671875 20.6716C0.671875 9.62594 9.62618 0.671631 20.6719 0.671631H249.329C260.374 0.671631 269.329 9.62594 269.329 20.6716V249.328C269.329 260.374 260.374 269.328 249.329 269.328H20.6719C9.62619 269.328 0.671875 260.374 0.671875 249.328V20.6716Z" fill="#EFEAD4" />
                    <Circle cx="135" cy="74.5522" r="40.2985" fill="#E99028" />
                    <Path d="M135.678 164.764L193.649 331.016H77.706L135.678 164.764Z" fill="#3B4E51" />
                    <Path d="M76.4193 138.427L134.391 304.68H18.4477L76.4193 138.427Z" fill="#5A786F" />
                    <Path d="M25.9401 109.896L83.9117 276.148H-32.0315L25.9401 109.896Z" fill="#B1BF80" />
                    <Path d="M201.52 125.259L259.492 291.511H143.548L201.52 125.259Z" fill="#5A786F" />
                    <Circle cx="34.2541" cy="58.8806" r="8.95522" fill="white" />
                    <Circle cx="43.2091" cy="49.9254" r="8.95522" fill="white" />
                    <Circle cx="47.6869" cy="61.1194" r="8.95522" fill="white" />
                    <Circle cx="54.4032" cy="54.403" r="6.71642" fill="white" />
                    <Circle cx="63.3585" cy="58.8806" r="6.71642" fill="white" />
                    <Circle cx="56.642" cy="58.8806" r="6.71642" fill="white" />
                </Svg>
        }
    ]
    const [index, setIndex] = useState(0);
    const scrollX = useRef(new Animated.Value(0)).current;

    const handleOnScroll = event => {
        Animated.event(
            [
                {
                    nativeEvent: {
                        contentOffset: {
                            x: scrollX,
                        },
                    },
                },
            ],
            {
                useNativeDriver: false,
            },
        )(event);
    };

    const handleOnViewableItemsChanged = useRef(({ viewableItems }) => {
        // console.log('viewableItems', viewableItems);
        setIndex(viewableItems[0].index);
    }).current;

    const viewabilityConfig = useRef({
        itemVisiblePercentThreshold: 50,
    }).current;



    return (
        <View>
            <FlatList
                data={Slides}
                renderItem={({ item }) => <SlideItem item={item} />}
                horizontal
                pagingEnabled
                snapToAlignment="center"
                showsHorizontalScrollIndicator={false}
                onScroll={handleOnScroll}
                onViewableItemsChanged={handleOnViewableItemsChanged}
                viewabilityConfig={viewabilityConfig}
            />
            <Pagination data={Slides} scrollX={scrollX} index={index} />
        </View>
    );
};

export default Slider;

const styles = StyleSheet.create({});